var AcuantCameraUI=function(){"use strict";let e=null,t=null,a=null,i=null,n={start:function(e,a,n){s=a,n&&(g=n);AcuantCamera.isCameraSupported?r||(r=!0,w(),function(e){var a=0,n=(new Date).getTime();i=document.getElementById("acuant-camera"),i&&i.addEventListener("acuantcameracreated",T);AcuantCamera.start((i=>{!function(e,t){if(t>=3)return!0;{let t=(new Date).getTime()-e;return t<v&&(v=t),v<p}}(n,a)?(a+=1,n=(new Date).getTime(),AcuantCamera.setRepeatFrameProcessor()):v<p?function(e,t){if(e){if(o&&-1===o.state)return;t.onFrameAvailable&&t.onFrameAvailable(e),o=e,o.state===AcuantCamera.DOCUMENT_STATE.GOOD_DOCUMENT?null===l&&(d=(new Date).getTime(),function(e){null===l&&(l=setTimeout((function(){o.state=h,A(e,"AUTO")}),f))}(t)):(y(),d=null)}else y(),d=null}(i,e):function(e){o={state:m},t.addEventListener("click",C,!1),t.callback=e}(e)}),e,E)}(e)):E("Camera not supported.",AcuantJavascriptWebSdk.START_FAIL_CODE)},end:b},r=!1,o=null,d=null,c=null,s=null,l=null,u=null;const h=-1,m=-2;let g={text:{NONE:"ALIGN",SMALL_DOCUMENT:"MOVE CLOSER",GOOD_DOCUMENT:null,CAPTURING:"CAPTURING",TAP_TO_CAPTURE:"TAP TO CAPTURE"}};const f=2e3,p=400;let v=Number.MAX_VALUE;function w(){o=null,d=null,c=null}function b(){w(),r=!1,l&&(clearTimeout(l),l=null),u&&(clearTimeout(u),u=null),e&&(e.removeEventListener("play",x,0),e=null),i&&i.removeEventListener("acuantcameracreated",T),t&&(t.removeEventListener("click",C),t.getContext("2d").clearRect(0,0,t.width,t.height)),AcuantCamera.end()}function y(){l&&(clearTimeout(l),l=null)}function C(e){A(e.currentTarget.callback,"TAP")}function T(){e=document.getElementById("acuant-player"),t=document.getElementById("acuant-ui-canvas"),a=t.getContext("2d"),t.setAttribute("role","img"),e.addEventListener("play",x,0)}function A(e,t){AcuantCamera.triggerCapture((a=>{b(),document.fullscreenElement?document.exitFullscreen().then((()=>{e.onCaptured(a)})):e.onCaptured(a),AcuantCamera.evaluateImage(a.data,a.width,a.height,t,(t=>{e.onCropped(t)}))}))}function E(e,t){b(),s&&s(e,t),s=null}function x(){!function i(){e&&!e.paused&&!e.ended&&r&&(!function(){if(a.clearRect(0,0,t.width,t.height),o)if(o.state===h)I("#00ff00"),D("rgba(0, 255, 0, 0.2)"),O(g.text.CAPTURING,.05,"#00ff00",!1);else if(o.state===m)I("#000000"),O(g.text.TAP_TO_CAPTURE);else if(o.state===AcuantCamera.DOCUMENT_STATE.GOOD_DOCUMENT)if(I("#ffff00"),D("rgba(255, 255, 0, 0.2)"),g.text.GOOD_DOCUMENT)O(g.text.GOOD_DOCUMENT,.09,"#ff0000",!1);else{let e=Math.ceil((f-((new Date).getTime()-d))/1e3);e<=0&&(e=1),O(e+"...",.09,"#ff0000",!1)}else o.state===AcuantCamera.DOCUMENT_STATE.SMALL_DOCUMENT?(I("#ff0000"),O(g.text.SMALL_DOCUMENT)):(I("#000000"),O(g.text.NONE));else I("#000000"),O(g.text.NONE)}(),u=setTimeout(i,100))}()}function O(e,t=.04,i="#ffffff",n=!0){let r=M(),o=window.orientation,d=a.measureText(e),c=.01*Math.max(r.width,r.height),s=.02*Math.max(r.width,r.height);var l=(r.height-s-d.width)/2,u=-(r.width/2-c),h=90;0!==o&&(h=0,l=(r.width-c-d.width)/2,u=r.height/2-s+.04*Math.max(r.width,r.height)),a.rotate(h*Math.PI/180),n&&(a.fillStyle="rgba(0, 0, 0, 0.5)",a.fillRect(Math.round(l-c),Math.round(u+c),Math.round(d.width+s),-Math.round(.05*Math.max(r.width,r.height)))),a.font=(Math.ceil(Math.max(r.width,r.height)*t)||0)+"px Sans-serif",a.fillStyle=i,a.fillText(e,l,u),S(e),a.rotate(-h*Math.PI/180)}const S=e=>{c||(c=document.createElement("p"),c.id="doc-state-text",c.style.height="1px",c.style.width="1px",c.style.margin="-1px",c.style.overflow="hidden",c.style.position="absolute",c.style.whiteSpace="nowrap",c.setAttribute("role","alert"),c.setAttribute("aria-live","assertive"),t.parentNode.insertBefore(c,t)),c.innerHTML!=e&&(c.innerHTML=e)};function M(){return-1==(e=navigator.userAgent.toLowerCase()).indexOf("safari")||e.indexOf("chrome")>-1?{height:t.height,width:t.width}:{height:Math.min(document.body.clientHeight,t.height),width:Math.min(document.body.clientWidth,t.width)};var e}function k(e,t){let i=window.orientation,n=M();var r=.08*n.width,o=.07*n.height;switch(0!==i&&(r=.07*n.width,o=.08*n.height),t.toString()){case"1":r=-r;break;case"2":r=-r,o=-o;break;case"3":o=-o}!function(e,t,i){a.beginPath();const n=Math.round(e.x),r=Math.round(e.y);a.moveTo(n,r),a.lineTo(Math.round(n+t),r),a.moveTo(n,r),a.lineTo(n,Math.round(r+i)),a.stroke()}(e,r,o)}function D(e){if(o&&o.points&&4===o.points.length){a.beginPath(),a.moveTo(Math.round(o.points[0].x),Math.round(o.points[0].y));for(var t=1;t<o.points.length;t++)a.lineTo(Math.round(o.points[t].x),Math.round(o.points[t].y));a.fillStyle=e,a.strokeStyle="rgba(0, 0, 0, 0)",a.stroke(),a.fill()}}function I(e){let t=M();if(a.lineWidth=Math.ceil(.0025*Math.max(t.width,t.height))||1,a.strokeStyle=e,o&&o.points&&(-1===o.state||o.state===AcuantCamera.DOCUMENT_STATE.GOOD_DOCUMENT))for(var i in o.points)k(o.points[i],i);else{var n,r,d={x:t.width/2,y:t.height/2};let e,a;t.width>t.height?(e=.85*t.width,a=.85*t.width/1.5887,a>.85*t.height&&(e=e/a*.85*t.height,a=.85*t.height)):(e=.85*t.height/1.5887,a=.85*t.height,e>.85*t.width&&(a=a/e*.85*t.width,e=.85*t.width)),[{x:d.x-(n=e/2),y:d.y-(r=a/2)},{x:d.x+n,y:d.y-r},{x:d.x+n,y:d.y+r},{x:d.x-n,y:d.y+r}].forEach(((e,t)=>{k(e,t)}))}}return n}(),AcuantCamera=function(){"use strict";let e=null,t=null,a=null,i=null,n=null,r=null;const o={NO_DOCUMENT:0,SMALL_DOCUMENT:1,GOOD_DOCUMENT:2},d={NONE:0,ID:1,PASSPORT:2},c=700,s=1920;let l,u=null,h=null,m=null,g=!1,f=!1,p=null,v={start:D,startManualCapture:I,triggerCapture:function(t){let a;try{if(0==e.videoWidth)throw"width 0";n.width=e.videoWidth,n.height=e.videoHeight,r.drawImage(e,0,0,n.width,n.height),a=r.getImageData(0,0,n.width,n.height),r.clearRect(0,0,n.width,n.height)}catch(e){return void q()}t({data:a,width:n.width,height:n.height})},end:W,DOCUMENT_STATE:o,ACUANT_DOCUMENT_TYPE:d,isCameraSupported:"mediaDevices"in navigator&&(T=!1,C=navigator.userAgent||navigator.vendor||window.opera,void((/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|playbook|silk/i.test(C)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(C.substr(0,4)))&&(T=!0)),(T||E())&&!(navigator.userAgent.toLowerCase().indexOf("firefox")>-1)),isIOSWebview:(w=window.navigator.standalone,b=window.navigator.userAgent.toLowerCase(),y=/safari/.test(b),/iphone|ipod|ipad/.test(b)&&!y&&!w),isIOS:E,setRepeatFrameProcessor:j,evaluateImage:J};var w,b,y,C,T;function A(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]}return""}function E(){return/iPad|iPhone|iPod/.test(navigator.platform)&&A()[0]>=13||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1}var x=function(){let e={targetWidth:window.innerWidth||950,targetHeight:window.innerHeight,frameScale:1,primaryConstraints:{video:{facingMode:{exact:"environment"},aspectRatio:1*Math.max(window.innerWidth,window.innerHeight)/Math.min(window.innerWidth,window.innerHeight),resizeMode:"none",frameRate:{min:10,ideal:15,max:15}}}};E()?(e.primaryConstraints.video.aspectRatio=4/3,e.primaryConstraints.video.width={min:s,ideal:s}):(e.primaryConstraints.video.height={min:1440,ideal:1440},function(){const e=navigator.userAgent.match(/SM-[N|G]\d{3}/);if(!e)return!1;const t=parseInt(e[0].match(/\d{3}/)[0],10);return!isNaN(t)&&t>=970}()&&(e.primaryConstraints.video.zoom=2));return e}();function O(t){g=!0,e.srcObject=t,window.addEventListener("resize",R),e&&(e.addEventListener("play",F),e.addEventListener("loadedmetadata",z)),e.play()}function S(e,t){document.cookie="AcuantCameraHasFailed="+t,W(),h&&"function"==typeof h?document.fullscreenElement?document.exitFullscreen().then((()=>{h(e,t)})):h(e,t):(console.error("No error callback set. Review implementation."),console.error(e,t))}function M(){return new Promise((e=>{navigator.mediaDevices.enumerateDevices().then((function(t){const a={suffix:void 0,device:void 0};t.filter((e=>"videoinput"===e.kind)).forEach((function(e){var t;if(e.getCapabilities&&e.getCapabilities().facingMode.length&&"environment"===e.getCapabilities().facingMode[0]||(t=e.label,["rear","back","rück","arrière","trasera","trás","traseira","posteriore","后面","後面","背面","задней","الخلفية","후","arka","achterzijde","หลัง","baksidan","bagside","sau","bak","tylny","takakamera","belakang","אחורית","πίσω","spate","hátsó","zadní","darrere","zadná","задня","stražnja","belakang","बैक"].some((e=>t.includes(e))))){let t=e.label.split(","),i=parseInt(t[0][t[0].length-1]);(i||0===i)&&(void 0===a.suffix||a.suffix>i)&&(a.suffix=i,a.device=e)}})),e(a.device)})).catch((function(t){e()}))}))}function k(e,t=0){function a(e){N()?O(e):function(e){l.requestFullscreen().then((function(){O(e)})).catch((function(t){O(e)}))}(e)}const i=Boolean(e.video.deviceId);navigator.mediaDevices.getUserMedia(e).then((e=>{!i&&t<2?M().then((function(i){i&&i.deviceId!==e.getVideoTracks()[0].getSettings().deviceId?(x.primaryConstraints.video.deviceId=i.deviceId,L(e),k(x.primaryConstraints,t++)):a(e)})):a(e)})).catch((e=>{S(e,AcuantJavascriptWebSdk.START_FAIL_CODE)}))}function D(i,o,d){if(d&&(h=d),function(){let e="AcuantCameraHasFailed=";return decodeURIComponent(document.cookie).includes(e)}())return d("Live capture has previously failed and was called again. User was sent to manual capture.",AcuantJavascriptWebSdk.REPEAT_FAIL_CODE),void I(o);l=document.getElementById("acuant-camera"),l?(l.style.position="relative",l.style.boxSizing="border-box",l.innerHTML='<video id="acuant-player" width="100%" height="auto" autoplay playsinline style="display:block; image-orientation:none;"></video><canvas id="acuant-ui-canvas" width="100%" height="auto" style="display:block; position:absolute; top:0; left:0;"></canvas>',e=document.getElementById("acuant-player"),n=document.createElement("canvas"),r=n.getContext("2d"),t=document.getElementById("acuant-ui-canvas"),g?S("already started.",AcuantJavascriptWebSdk.START_FAIL_CODE):e&&t?(a=t.getContext("2d"),i&&(u=i),l.dispatchEvent(new Event("acuantcameracreated")),M().then((e=>{e&&(x.primaryConstraints.video.deviceId=e.deviceId),k(x.primaryConstraints)}))):S("Missing HTML elements.",AcuantJavascriptWebSdk.START_FAIL_CODE)):S("Expected div with 'acuant-camera' id",AcuantJavascriptWebSdk.START_FAIL_CODE)}function I(e){m=e,i||(i=document.createElement("input"),i.type="file",i.capture="environment",i.accept="image/*",i.onclick=function(e){e&&e.target&&(e.target.value="")}),i.onchange=_,i.click()}let U=-1;function _(e){let t=e.target,a=new FileReader;n=document.createElement("canvas"),r=n.getContext("2d"),a.onload=e=>{U=function(e){var t=new DataView(e.target.result);if(65496!=t.getUint16(0,!1))return-2;for(var a=t.byteLength,i=2;i<a;){if(t.getUint16(i+2,!1)<=8)return-1;var n=t.getUint16(i,!1);if(i+=2,65505==n){if(1165519206!=t.getUint32(i+=2,!1))return-1;var r=18761==t.getUint16(i+=6,!1);i+=t.getUint32(i+4,r);var o=t.getUint16(i,r);i+=2;for(var d=0;d<o;d++)if(274==t.getUint16(i+12*d,r))return t.getUint16(i+12*d+8,r)}else{if(65280!=(65280&n))break;i+=t.getUint16(i,!1)}}return-1}(e);let t=document.createElement("img");t.src="data:image/jpeg;base64,"+V(e.target.result),t.onload=()=>{let e=2560,a=1920,i=t.width,o=t.height;(E()&&(e=s,a=Math.floor(1440)),(i>o?i:o)>e)?i<o?(a=e,e=a/(o/i)):a=e/(i/o):(e=t.width,a=t.height);n.width=e,n.height=a,r.mozImageSmoothingEnabled=!1,r.webkitImageSmoothingEnabled=!1,r.msImageSmoothingEnabled=!1,r.imageSmoothingEnabled=!1,r.drawImage(t,0,0,e,a),i=e,o=a;var d=r.getImageData(0,0,i,o);r.clearRect(0,0,e,a),t.remove(),m.onCaptured({data:d,width:i,height:o}),J(d,i,o,"MANUAL",m.onCropped)}},t&&t.files[0]&&a.readAsArrayBuffer(t.files[0])}function N(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("safari")&&!(e.indexOf("chrome")>-1)}function L(e){e.getTracks().forEach((e=>{e.stop()}))}function W(){g=!1,f=!1,U=-1,p&&(clearTimeout(p),p=null),window.removeEventListener("resize",R),e&&(e.removeEventListener("play",F),e.removeEventListener("loadedmetadata",z)),e&&(e.pause(),e.srcObject&&L(e.srcObject),e=null),l&&(l.innerHTML=""),i&&(i.remove(),i=null)}function A(){if(/iP(hone|od|ad)/.test(navigator.platform))try{const e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]}catch(e){return-1}return-1}function R(){a.clearRect(0,0,t.width,t.height),e&&(E()&&(function(){var e=window.navigator.userAgent,t=e.indexOf("WebKit")>-1,a=e.indexOf("CriOS")>-1;return t&&a&&E()}()||function(){let e=A();return e&&-1!=e&&e.length>=2&&14==e[0]&&e[1]>=4}())?(W(),D()):P())}function P(){var a=0,i=0;N()?(a=document.body.clientWidth,i=document.body.clientHeight):(a=window.innerWidth,i=window.innerHeight),e.videoWidth<e.videoHeight?x.canvasScale=e.videoHeight/e.videoWidth:x.canvasScale=e.videoWidth/e.videoHeight,window.matchMedia("(orientation: portrait)").matches?(e.width=t.width=a,e.height=t.height=a*x.canvasScale):(e.width=t.width=i*x.canvasScale,e.height=t.height=i)}function H(){e&&!e.paused&&(j(),p=setTimeout(H,100))}function z(){e.videoWidth+e.videoHeight<1e3?(W(),S("Camera not supported",AcuantJavascriptWebSdk.START_FAIL_CODE)):(P(),H())}function F(){p&&(clearTimeout(p),f=!1,H())}function j(){if(!g||f)return;if(0==e.videoWidth)return void q();f=!0;let t=Math.max(e.videoWidth,e.videoHeight),a=Math.min(e.videoWidth,e.videoHeight),i=0,s=0;if(t>c&&a>500?e.videoWidth>=e.videoHeight?(x.frameScale=c/e.videoWidth,s=c,i=e.videoHeight*x.frameScale):(x.frameScale=c/e.videoHeight,s=e.videoWidth*x.frameScale,i=c):(x.frameScale=1,s=e.videoWidth,i=e.videoHeight),s==n.width&&i==n.height||(n.width=s,n.height=i),g){let t;try{r.drawImage(e,0,0,e.videoWidth,e.videoHeight,0,0,n.width,n.height),t=r.getImageData(0,0,n.width,n.height),r.clearRect(0,0,n.width,n.height)}catch(e){return void q()}!function(t,a,i){AcuantJavascriptWebSdk.detect(t,a,i,{onSuccess:function(t){if(n&&e&&!e.paused&&!e.ended){t.points.forEach((t=>{void 0!==t.x&&void 0!==t.y&&(t.x=t.x/x.frameScale*e.width/e.videoWidth,t.y=t.y/x.frameScale*e.height/e.videoHeight)}));var a=t.isCorrectAspectRatio&&(Math.min(t.dimensions.width,t.dimensions.height)/Math.min(n.width,n.height)>.75||Math.max(t.dimensions.width,t.dimensions.height)/Math.max(n.width,n.height)>.8);t.type===d.NONE?t.state=o.NO_DOCUMENT:t.state=a?o.GOOD_DOCUMENT:o.SMALL_DOCUMENT,u(t),f=!1}},onFail:function(){if(!n||!e||e.paused||e.ended)return;let t={};t.state=o.NO_DOCUMENT,u(t),f=!1}})}(t,n.width,n.height)}}function J(e,t,a,i,n){let r={},o=!0;AcuantJavascriptWebSdk.moire(e,t,a,{onSuccess:function(e,t){r.moire=e,r.moireraw=t,o?o=!1:G(r,i,n)},onFail:function(){r.moire=-1,r.moireraw=-1,o?o=!1:G(r,i,n)}}),AcuantJavascriptWebSdk.crop(e,t,a,{onSuccess:function(e){r.cardtype=e.cardtype,r.dpi=e.dpi,r.image=e.image,o?o=!1:G(r,i,n)},onFail:function(){n()}})}function G(e,t,a){async function i(i,o){e.sharpness=i,e.glare=o,e.image.data=await async function(e,t){n&&r||(n=document.createElement("canvas"),r=n.getContext("2d"));n.width=e.image.width,n.height=e.image.height;let a=r.createImageData(e.image.width,e.image.height);(function(e,t){for(let a=0;a<e.length;++a)e[a]=t[a]})(a.data,e.image.data),r.putImageData(a,0,0);let i="AUTO"!=t&&"TAP"!=t;2!==e.cardtype&&(!i&&window.matchMedia("(orientation: portrait)").matches||i&&6===U)&&(r.rotate(Math.PI),r.drawImage(n,0,0,-n.width,-n.height));e.image.bytes=r.getImageData(0,0,n.width,n.height).data;let o="undefined"!=typeof acuantConfig&&"number"==typeof acuantConfig.jpegQuality?acuantConfig.jpegQuality:1,d=n.toDataURL("image/jpeg",o);r.clearRect(0,0,n.width,n.height),n&&(r=null,n.remove(),n=null);return await async function(e,t,a){const i=await new Promise((e=>{AcuantJavascriptWebSdk.getCvmlVersion({onSuccess:t=>{e(t)},onFail:()=>{e("unknown")}})})),n=JSON.stringify({cvml:{cropping:{iscropped:!0,dpi:e.dpi,idsize:2===e.cardType?"ID3":"ID1",elapsed:-1},sharpness:{normalized:e.sharpness,elapsed:-1},moire:{normalized:e.moire,raw:e.moireraw,elapsed:-1},glare:{normalized:e.glare,elapsed:-1},version:i},device:{version:B(),capturetype:t}});return AcuantJavascriptWebSdk.addMetadata(a,{imageDescription:n,dateTimeOriginal:(new Date).toUTCString()})}(e,t,d)}(e,t),function(e,t){const a=function(e){for(var t=window.atob(e.split("base64,")[1]),a=t.length,i=new Uint8Array(new ArrayBuffer(a)),n=0;n<a;n++)i[n]=t.charCodeAt(n);return i}(e.image.data);AcuantJavascriptWebSdk.sign(a,{onSuccess:function(a){e.image.data="data:image/jpeg;base64,"+V(a),t(e)},onFail:function(){t()}})}(e,a)}AcuantJavascriptWebSdk.metrics(e.image,e.image.width,e.image.height,{onSuccess:i,onFail:()=>i(-1,-1)})}function B(){var e,t=navigator.userAgent,a=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(a[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===a[1]&&null!=(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(a=a[2]?[a[1],a[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&a.splice(1,1,e[1]),a.join(" "))}function q(){(function(){let e=A();return e&&-1!=e&&e.length>=1&&15==e[0]})()||navigator.maxTouchPoints&&navigator.maxTouchPoints>=2&&/MacIntel/.test(navigator.platform)?S("Camera capture failed due to unexpected sequence break. This usually indicates the camera closed or froze unexpectedly. In iOS 15+ this is intermittently occurs due to a GPU Highwater failure. Swap to manual capture until the user fully reloads the browser. Attempting to continue to use live capture can lead to further Highwater errors and can cause to OS to cut off the webpage.",AcuantJavascriptWebSdk.SEQUENCE_BREAK_CODE):S("Camera capture failed due to unexpected sequence break. This usually indicates the camera closed or froze unexpectedly. Swap to manual capture until the user fully reloads the browser.",AcuantJavascriptWebSdk.SEQUENCE_BREAK_CODE)}function V(e){for(var t="",a=new Uint8Array(e),i=a.byteLength,n=0;n<i;n++)t+=String.fromCharCode(a[n]);return window.btoa(t)}return v}();